<div class="main-container">
  <div class="title">
    <div class="title-icon">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M416 192H384V128C384 57.422 326.578 0 256 0S128 57.422 128 128V192H96C60.654 192 32 220.654 32 256V448C32 483.346 60.654 512 96 512H416C451.346 512 480 483.346 480 448V256C480 220.654 451.346 192 416 192ZM176 128C176 83.891 211.891 48 256 48S336 83.891 336 128V192H176V128ZM432 448C432 456.822 424.822 464 416 464H96C87.178 464 80 456.822 80 448V256C80 247.178 87.178 240 96 240H416C424.822 240 432 247.178 432 256V448ZM256 304C242.75 304 232 314.75 232 328V376C232 389.25 242.75 400 256 400S280 389.25 280 376V328C280 314.75 269.25 304 256 304Z"/></svg>
    </div>
    <div class="title-text">
        {{ isLinkValid ? 'Set new password' : 'Invalid reset link' }}
    </div>
    <div class="title-small">
        {{ isLinkValid ? 'Your new password must be different to previously used passwords.' : 'The link you accessed is invalid please request a new one' }}
    </div>
  </div>

  @if (isLinkValid) {
    <form
        class="new-password-form"
        [formGroup]="newPasswordForm">
      <div class="form-field">
        <input
        id="password"
        type="password"
        placeholder="New password"
        pInputText
        formControlName="password" />
      </div>
      <div class="form-field">
        <input
        id="password-confirmation"
        type="password"
        placeholder="Confirm new password"
        pInputText formControlName="passwordConfirmation"/>
      </div>
    </form>
  }

  @if (isLinkValid) {
    <div class="actions">
      @if (!isActionInProgress) {
        <button
            pButton
            pRipple
            type="button"
            label="Reset password"
            class="p-button-rounded"
            (click)="onResetPassword()"
            [disabled]="!newPasswordForm.valid"></button>
      } @else {
        <p-progressSpinner [style]="{width: '30px', height: '30px', marginTop: '.5rem'}"></p-progressSpinner>
      }
    </div>
  }

  @if (isLinkValid) {
    <div class="back-to-login">
      <div class="back-to-login-btn">
        <div routerLink="/auth/login" class="label">
          Back to log in
        </div>
      </div>
    </div>
  }
</div>
